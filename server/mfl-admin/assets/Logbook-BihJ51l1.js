import{s as H,a as z,b as J}from"./index-Z1mY45GO.js";import{s as P,a as R,b as Z}from"./index-CWOciPov.js";import{s as q,a as G}from"./index-aqDJwCED.js";import{r,w as K,o as p,c as h,a,b as e,d as n,e as v,F as Q,i as W,j as D,t as s,f as X,h as j}from"./index-lWlk8XG8.js";import{h as ee}from"./ApiService-S8GRmx5O.js";import{L as te}from"./LogbookService-CeffOqyL.js";import"./index-BJLd3FNP.js";import"./AuthService-TS0M5ZGt.js";const le={className:"card"},ae=a("h1",{style:{float:"left"}},"Flugbuch",-1),oe=a("div",{style:{clear:"both"}},null,-1),ne={className:"card"},ie={key:0},re=["innerHTML"],se=a("br",null,null,-1),de={class:"flex justify-end"},ue=a("i",{class:"pi pi-search"},null,-1),ce=a("br",null,null,-1),pe={key:0},me={class:"flex items-center gap-4 py-1 px-2 justify-between"},fe={class:"text-color font-medium"},_e={class:"hidden sm:block"},he={class:"block sm:hidden"},ve={key:0},Le={__name:"Logbook",setup(ge){const g=r([]),b=r(""),d=r({global:{}}),F=r(null),m=r(new Date().getFullYear()),w=r(Array.from({length:new Date().getFullYear()-2024+1},(l,o)=>new Date().getFullYear()-o)),f=r("MFL Flugbuch"),_=r(!1);K(()=>X.path,y,{immediate:!0});function y(){g.value=[],_.value=!0,V(),te.get(m.value).then(l=>{l.forEach(o=>{o.startDate=o.start}),g.value=l}).catch(l=>ee(l,b)).finally(()=>{_.value=!1})}function V(){f.value=`MFL Flugbuch ${m.value}`,d.value.global.value!=null&&d.value.global.value.length>0&&(f.value=`${f.value} ${d.value.global.value}`)}function L(){F.value.exportCSV()}function be(){}function S(l){return l.field==="startDate"&&l.data instanceof Date?l.data.toLocaleDateString([],{day:"2-digit",month:"2-digit",year:"numeric"}):(l.field==="start"||l.field==="end")&&l.data instanceof Date?l.data.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):l.data===!0?"Ja":l.data===!1?"Nein":l.data}return(l,o)=>{const u=j,C=q,$=P,B=Z,M=G,T=R,i=z,E=J,N=H;return p(),h(Q,null,[a("div",le,[ae,e(u,{onClick:y,icon:"pi pi-refresh",severity:"secondary",style:{float:"right"}}),oe]),a("div",ne,[b.value.length>0?(p(),h("div",ie,[e(C,{severity:"error",closable:!0},{default:n(()=>[a("div",{innerHTML:b.value},null,8,re)]),_:1}),se])):v("",!0),a("div",de,[e($,{modelValue:m.value,"onUpdate:modelValue":o[0]||(o[0]=t=>m.value=t),options:w.value,onChange:y},null,8,["modelValue","options"]),e(T,null,{default:n(()=>[e(B,null,{default:n(()=>[ue]),_:1}),e(M,{modelValue:d.value.global.value,"onUpdate:modelValue":o[1]||(o[1]=t=>d.value.global.value=t),placeholder:"Volltextfilter",onInput:V},null,8,["modelValue"])]),_:1}),e(u,{label:"Exportieren",onClick:L,severity:"secondary"})]),ce,e(N,{ref_key:"table",ref:F,value:g.value,tableStyle:"min-width: 50rem",sortField:"start",sortOrder:-1,selectionMode:"multiple",onRowClick:o[2]||(o[2]=t=>void 0),paginator:"",rows:9999,filters:d.value,"onUpdate:filters":o[3]||(o[3]=t=>d.value=t),globalFilterFields:["airport","pilotname","comment","start"],exportFunction:S,"export-filename":f.value},{empty:n(()=>[_.value?(p(),h("div",pe,"Daten werden geladen ...")):v("",!0),_.value?v("",!0):(p(),W(C,{key:1},{default:n(()=>[D("Es wurden keine Daten gefunden, welche den Filterkriterien entsprechen")]),_:1}))]),paginatorcontainer:n(({first:t,last:k,page:c,pageCount:x,prevPageCallback:I,nextPageCallback:O,totalRecords:U,firstPageCallback:Y,lastPageCallback:A})=>[a("div",me,[e(u,{icon:"pi pi-angle-double-left",rounded:"",text:"",onClick:Y,disabled:c===0},null,8,["onClick","disabled"]),e(u,{icon:"pi pi-angle-left",rounded:"",text:"",onClick:I,disabled:c===0},null,8,["onClick","disabled"]),a("div",fe,[a("span",_e,"Zeilen "+s(t)+"-"+s(k)+" von "+s(U),1),a("span",he,"Seite "+s(c+1)+" von "+s(x),1)]),e(u,{icon:"pi pi-angle-right",rounded:"",text:"",onClick:O,disabled:c===x-1},null,8,["onClick","disabled"]),e(u,{icon:"pi pi-angle-double-right",rounded:"",text:"",onClick:A,disabled:c===x-1},null,8,["onClick","disabled"])])]),default:n(()=>[e(i,{field:"startDate",header:"Datum",sortable:""},{body:n(({data:t})=>[a("span",null,s(t.startDate.toLocaleDateString([],{day:"2-digit",month:"2-digit",year:"numeric"})),1)]),_:1}),e(i,{field:"airport",header:"Flugplatz",sortable:""}),e(i,{field:"pilotname",header:"Pilot",sortable:""}),e(i,{field:"start",header:"Beginn",sortable:""},{body:n(({data:t})=>[D(s(t.start.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})),1)]),_:1}),e(i,{field:"end",header:"Ende",sortable:""},{body:n(({data:t})=>[t.end?(p(),h("span",ve,s(t.end.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})),1)):v("",!0)]),_:1}),e(i,{field:"takeoffcount",header:"Flüge",sortable:""}),e(i,{field:"maxAltitude",header:"Max. Flughöhe",sortable:""}),e(i,{field:"airspaceObserver",header:"Luftraum-Beobachter",sortable:""},{body:n(({data:t})=>[e(E,{modelValue:t.airspaceObserver,"onUpdate:modelValue":k=>t.airspaceObserver=k,binary:"",readonly:"readonly"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(i,{field:"comment",header:"Besonderheiten, Vorkommnisse",sortable:""})]),_:1},8,["value","filters","export-filename"])])],64)}}};export{Le as default};
