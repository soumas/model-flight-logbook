import{s as E,a as M,b as P,c as B,d as N}from"./index-BlCLpRe_.js";import{s as A,a as O}from"./index-7uEtTdfL.js";import{A as f,J as u,s as U,h as I}from"./ApiService-C9hcrDor.js";import{r as p,w as J,c as h,e as t,u as H,f as r,g as v,a as i,o as _,h as y,t as g,b as R}from"./index-DJzmeOUY.js";import"./AuthService-B6EG3m7n.js";const q={getPath(s){const o="/admin/flightsession";return s?o+"/"+s:o},async get(s){const o=(await f.get(this.getPath(s))).data;return u.stringsToDates(o),o},async update(s,o){try{u.datesToStrings(o);const d=(await f.put(this.getPath(s),o)).data;return u.stringsToDates(d),d}catch(d){throw u.stringsToDates(o),d}},async delete(s){return f.delete(this.getPath(s))}},z={className:"card"},G=i("h1",null,"Flugbuch",-1),K={key:0},Q=i("br",null,null,-1),W=["innerHTML"],X=i("br",null,null,-1),Y={class:"flex justify-end"},Z=i("i",{class:"pi pi-search"},null,-1),j={key:0},ne={__name:"Logbook",setup(s){const o=p([]),d=Array({label:"Export",icon:"pi pi-fw pi-user-plus",command:()=>V()}),m=p(""),c=p({global:{}}),b=p(null);J(()=>R.path,D,{immediate:!0});function D(){q.get().then(e=>{e.forEach(n=>{n.startDate=n.start}),o.value=e}).catch(e=>I(e,m))}function V(){b.value.exportCSV()}function ee(){}function x(e){return e.field==="startDate"&&e.data instanceof Date?e.data.toLocaleDateString():(e.field==="start"||e.field==="end")&&e.data instanceof Date?e.data.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):e.data===!0?"Ja":e.data===!1?"Nein":e.data}return(e,n)=>{const k=U,w=A,S=M,T=O,L=P,l=B,F=N,C=E;return _(),h("div",z,[G,t(k,{model:H(d)},null,8,["model"]),m.value.length>0?(_(),h("div",K,[Q,t(w,{severity:"error",closable:!0},{default:r(()=>[i("div",{innerHTML:m.value},null,8,W)]),_:1})])):v("",!0),X,t(C,{ref_key:"table",ref:b,value:o.value,tableStyle:"min-width: 50rem",sortField:"start",sortOrder:-1,selectionMode:"multiple",onRowClick:n[1]||(n[1]=a=>void 0),paginator:"",rows:20,rowsPerPageOptions:[20,50,100,200,500],filters:c.value,"onUpdate:filters":n[2]||(n[2]=a=>c.value=a),globalFilterFields:["pilotid"],exportFunction:x},{empty:r(()=>[y(" Es gibt noch keinen Eintrag im Logbuch ")]),header:r(()=>[i("div",Y,[t(L,null,{default:r(()=>[t(S,null,{default:r(()=>[Z]),_:1}),t(T,{modelValue:c.value.global.value,"onUpdate:modelValue":n[0]||(n[0]=a=>c.value.global.value=a),placeholder:"Filter"},null,8,["modelValue"])]),_:1})])]),default:r(()=>[t(l,{field:"startDate",header:"Datum",sortable:""},{body:r(({data:a})=>[i("span",null,g(a.startDate.toLocaleDateString()),1)]),_:1}),t(l,{field:"pilotid",header:"Pilot",sortable:""}),t(l,{field:"start",header:"Beginn",sortable:""},{body:r(({data:a})=>[y(g(a.start.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})),1)]),_:1}),t(l,{field:"end",header:"Ende",sortable:""},{body:r(({data:a})=>[a.end?(_(),h("span",j,g(a.end.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})),1)):v("",!0)]),_:1}),t(l,{field:"takeoffcount",header:"Flüge",sortable:""}),t(l,{field:"maxAltitude",header:"Max. Flughöhe",sortable:""}),t(l,{field:"airspaceObserver",header:"Luftraum-Beobachter",sortable:""},{body:r(({data:a})=>[t(F,{modelValue:a.airspaceObserver,"onUpdate:modelValue":$=>a.airspaceObserver=$,binary:"",readonly:"readonly"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(l,{field:"comment",header:"Besonderheiten, Vorkommnisse",sortable:""})]),_:1},8,["value","filters"])])}}};export{ne as default};
